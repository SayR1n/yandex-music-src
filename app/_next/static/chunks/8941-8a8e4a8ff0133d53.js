(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8941],{12277:(e,t,a)=>{"use strict";a.d(t,{cY:()=>p.MusicHistoryIntersectionObserverContext,UN:()=>K,ln:()=>E.MusicHistoryTab,WW:()=>R,tM:()=>i,Hp:()=>r,uZ:()=>s,QF:()=>l,u:()=>n,z:()=>_,bg:()=>k,kU:()=>S,sr:()=>j,Sv:()=>b,lT:()=>I.useFormatDate});let i=e=>e.data.itemId.id,r=e=>e.data.itemId.id,s=e=>{let{uid:t,kind:a}=e.data.itemId;return"".concat(t,":").concat(a)},l=e=>{let{albumId:t,trackId:a}=e.data.itemId;return t?"".concat(a,":").concat(t):a},n=e=>e.data.itemId.seeds.sort().join(",");var o=a(41028),c=a(61475),d=a(52732),m=a(94767),u=a(44078);let v=e=>{if("fullModel"in e.data){let{fullModel:t}=e.data;return(0,o.wg)({type:c.D.TRACK,id:l(e),loadingState:m.GuX.RESOLVE,data:(0,u.vU)(t)})}return(0,o.wg)({type:c.D.TRACK,id:l(e),data:null,loadingState:m.GuX.IDLE})};var h=a(70879),y=a(54960),g=a(45242),x=a(65582);let b=e=>{var t,a;let l=null==(t=e.items)?void 0:t.map(e=>{switch(e.context.type){case c.D.ALBUM:return((e,t)=>{let{data:a}=e;if("fullModel"in a){let{fullModel:r}=a;return(0,o.wg)({type:c.D.ALBUM,available:r.available,id:i(e),meta:(0,d.sK)({album:r.album,artists:r.artists}),loadingState:m.GuX.RESOLVE,tracks:t.map(v)})}return(0,o.wg)({type:c.D.ALBUM,available:!0,id:i(e),meta:null,loadingState:m.GuX.IDLE,tracks:t.map(v)})})(e.context,e.tracks);case c.D.PLAYLIST:return((e,t)=>{let{data:a,type:i}=e;if("fullModel"in a){let{fullModel:r}=a;return(0,o.wg)({type:i,id:s(e),meta:{...(0,g.bk)({playlist:r.playlist}),tracksCount:r.tracksCount},loadingState:m.GuX.RESOLVE,tracks:t.map(v)})}return(0,o.wg)({type:c.D.PLAYLIST,id:s(e),meta:null,loadingState:m.GuX.IDLE,tracks:t.map(v)})})(e.context,e.tracks);case c.D.ARTIST:return((e,t)=>{let{data:a,type:i}=e;if("fullModel"in a){let{fullModel:s}=a;return(0,o.wg)({type:i,available:s.available,id:r(e),meta:(0,h.as)({artist:s.artist}),loadingState:m.GuX.RESOLVE,tracks:t.map(v)})}return(0,o.wg)({type:i,available:!0,id:r(e),meta:null,loadingState:m.GuX.IDLE,tracks:t.map(v)})})(e.context,e.tracks);case c.D.WAVE:return((e,t)=>{let{data:a,type:i}=e;if("fullModel"in a){let{fullModel:r}=a;return(0,o.wg)({type:i,id:n(e),meta:{...(0,x.er)(r.wave),imageUrl:r.simpleWaveForegroundImageUrl,backgroundColor:r.simpleWaveBackgroundColor},loadingState:m.GuX.RESOLVE,tracks:t.map(v)})}return(0,o.wg)({type:i,id:n(e),meta:null,loadingState:m.GuX.IDLE,tracks:t.map(v)})})(e.context,e.tracks);case c.D.SEARCH:case c.D.OTHER:return((e,t)=>{let{type:a}=e;return(0,o.wg)({type:a,id:(0,y.A)(),tracks:t.map(v)})})(e.context,e.tracks);default:return null}}).filter(e=>e);return{date:e.date,blocks:null!=(a=(0,o.wg)(l))?a:null}};var p=a(54990);let _=e=>(null==e?void 0:e.type)===c.D.ALBUM,k=e=>(null==e?void 0:e.type)===c.D.ARTIST,S=e=>(null==e?void 0:e.type)===c.D.PLAYLIST,j=e=>(null==e?void 0:e.type)===c.D.WAVE;var I=a(78087),A=a(59615),M=a(25581);let C=e=>({type:M.z4.Unloaded,meta:{id:e.entityId}}),H=o.gK.compose(o.gK.model("MusicHistoryTrack",{type:o.gK.literal(c.D.TRACK),id:o.gK.string,data:o.gK.maybeNull(u.vj)}),A.XT).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get isShimmerVisible(){return e.isNeededToLoad||e.isLoading||e.isRejected},get isShimmerActive(){return e.isLoading},get entityId(){var t;if(!e.data)return e.id;let{id:a,albums:i}=e.data,r=null==(t=i[0])?void 0:t.id;return r?"".concat(a,":").concat(r):a}})).named("MusicHistoryPlaylist"),N=o.gK.compose(o.gK.model("MusicHistoryBaseBlock",{id:o.gK.string,tracks:o.gK.array(H)}),A.XT).views(e=>({get isShimmerVisible(){return e.isNeededToLoad||e.isLoading||e.isRejected},get isShimmerActive(){return e.isLoading},get contextId(){return e.id},get entitiesData(){return e.tracks.map(C)}})),f=N.props({type:o.gK.literal(c.D.ALBUM),available:o.gK.boolean,meta:o.gK.maybeNull(d.JC)}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get autoflowSeeds(){var t;return["album:".concat(null==(t=e.meta)?void 0:t.id)]}})).named("MusicHistoryAlbum"),w=N.props({type:o.gK.literal(c.D.ARTIST),available:o.gK.boolean,meta:o.gK.maybeNull(h.PK)}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get autoflowSeeds(){var t;return["artist:".concat(null==(t=e.meta)?void 0:t.id)]}})).named("MusicHistoryArtist"),T=o.gK.model("MusicHistoryCommon",{id:o.gK.string,type:o.gK.union(o.gK.literal(c.D.OTHER),o.gK.literal(c.D.SEARCH)),tracks:o.gK.array(H)}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get contextId(){return e.tracks.map(e=>e.id).join(",")},get entitiesData(){return e.tracks.map(C)}})),L=N.props({type:o.gK.literal(c.D.PLAYLIST),meta:o.gK.maybeNull(g.IP)}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get autoflowSeeds(){var t,a;return["playlist:".concat(null==(t=e.meta)?void 0:t.uid,"_").concat(null==(a=e.meta)?void 0:a.kind)]}})).named("MusicHistoryPlaylist"),P=N.props({id:o.gK.string,type:o.gK.literal(c.D.WAVE),meta:o.gK.maybeNull(x.Gh)}).views(e=>({get key(){return"".concat(e.type,"_").concat(e.id)},get contextId(){var t,a;return null!=(a=null==(t=e.meta)?void 0:t.stationId)?a:m.M19},get autoflowSeeds(){var i;return null==(i=e.meta)?void 0:i.seeds}})),D=o.gK.union(f,w,L,P,T),K=o.gK.compose(o.gK.model({id:o.gK.string,type:o.gK.enumeration(Object.values(c.D)),tabIndex:o.gK.number,blockIndex:o.gK.number,trackIndex:o.gK.maybeNull(o.gK.number)}),A.XT),R=o.gK.model("MusicHistoryTab",{date:o.gK.string,blocks:o.gK.maybeNull(o.gK.array(D))});var E=a(74557)},22914:e=>{e.exports={shimmersContainer:"MusicHistoryPageContentShimmer_shimmersContainer__82cj6",dateShimmer:"MusicHistoryPageContentShimmer_dateShimmer__d4_te",contextNameShimmer:"MusicHistoryPageContentShimmer_contextNameShimmer__Tzbqr",contextHeaderShimmer:"MusicHistoryPageContentShimmer_contextHeaderShimmer__Tq0PZ",trackListShimmers:"MusicHistoryPageContentShimmer_trackListShimmers__4GSp8"}},28149:e=>{e.exports={date:"MusicHistoryTab_date__Fjy3P",content:"MusicHistoryTab_content__Jt15j"}},54990:(e,t,a)=>{"use strict";a.d(t,{MusicHistoryIntersectionObserverContext:()=>i});let i=(0,a(66268).createContext)({observeElement:()=>{},unobserveElement:()=>{}})},61475:(e,t,a)=>{"use strict";var i;a.d(t,{D:()=>i}),function(e){e.TRACK="track",e.WAVE="wave",e.ARTIST="artist",e.PLAYLIST="playlist",e.ALBUM="album",e.OTHER="other",e.SEARCH="search"}(i||(i={}))},64552:e=>{e.exports={header:"MusicHistoryBlock_header__sIFVC",heading:"MusicHistoryBlock_heading__HEfmk",headerTitle:"MusicHistoryBlock_headerTitle__Yhyst",content:"MusicHistoryBlock_content__S9lfi",artists:"MusicHistoryBlock_artists__AjuWP",artistLink:"MusicHistoryBlock_artistLink__yFHPE",shimmerTitle:"MusicHistoryBlock_shimmerTitle__Mx1IC"}},68941:(e,t,a)=>{"use strict";a.d(t,{MusicHistoryPage:()=>A});var i=a(33008),r=a(85896),s=a(97531),l=a(66268),n=a(96560),o=a(18064),c=a(57747),d=a(21741),m=a(77868),u=a(12277),v=a(83888),h=a(94767),y=a(53799),g=a(32436);let x=e=>{let{children:t}=e,a=(0,l.useRef)({}),r=(0,l.useMemo)(()=>(0,g.Gv)(e=>{var t,i;let r=(0,g.L5)(e.target),s=a.current[r];e.isIntersecting?null==s||null==(t=s.onShow)||t.call(s):null==s||null==(i=s.onHide)||i.call(s)}),[]);(0,l.useEffect)(()=>()=>null==r?void 0:r.disconnect(),[r]);let s=(0,l.useCallback)(e=>{!a.current[e.elementId]&&e.elementRef.current&&(null==r||r.observe(e.elementRef.current),a.current[e.elementId]=e)},[r]),n=(0,l.useCallback)(e=>{let t=a.current[e];t&&t.elementRef.current&&(null==r||r.unobserve(t.elementRef.current))},[r]),o=(0,l.useMemo)(()=>({observeElement:s,unobserveElement:n}),[s,n]);return(0,i.jsx)(u.cY.Provider,{value:o,children:t})},b=async(e,t)=>new Promise(a=>{if("onscrollend"in window){var i;let r=()=>{var e;a(),null==(e=t.current)||e.removeEventListener("scrollend",r)};null==(i=t.current)||i.addEventListener("scrollend",r),e.scrollIntoView({behavior:"smooth"})}else e.scrollIntoView({behavior:"smooth"}),window.setTimeout(a,1e3)});var p=a(91907),_=a.n(p),k=a(91342),S=a(22914),j=a.n(S);let I=e=>{let{isActive:t}=e,a=(0,i.jsxs)("div",{className:j().trackListShimmers,children:[(0,i.jsx)(y.DS,{isActive:t,variant:h.Xjt.PLAYLIST}),(0,i.jsx)(y.DS,{isActive:t,variant:h.Xjt.PLAYLIST}),(0,i.jsx)(y.DS,{isActive:t,variant:h.Xjt.PLAYLIST})]});return(0,i.jsxs)("div",{className:j().shimmersContainer,children:[(0,i.jsx)(k.Shimmer,{isActive:t,className:j().dateShimmer}),(0,i.jsx)(k.Shimmer,{isActive:t,className:j().contextNameShimmer}),(0,i.jsx)(y.Mo,{withDescription:!0,className:j().contextHeaderShimmer}),a,(0,i.jsx)(k.Shimmer,{isActive:t,className:j().contextNameShimmer}),(0,i.jsx)(y.Mo,{coverRadius:"round",className:j().contextHeaderShimmer}),a]})},A=(0,s.PA)(()=>{let[e,t]=(0,l.useState)(!1),{musicHistory:a}=(0,h.Pjs)(),{contentScrollRef:s,setContentScrollRef:g}=(0,h.gKY)(),p=(0,d.useTabsState)(0),k=(0,l.useRef)(!1),S=(0,l.useRef)(null),j=(0,l.useCallback)(async e=>{var i;t(!0);let r=a.dates[e];if(!r)return;null==(i=p.onTabChange)||i.call(p,e),k.current=!0;let l=document.querySelector('[data-date-anchor="'.concat(r,'"]'));l&&(S.current=s,await b(l,S)),k.current=!1},[a.dates,p,s]),A=(0,l.useCallback)(()=>{if(k.current)return;let e=a.dates.findIndex(e=>a.datesMap.get(e));if(e>=0){var t;null==(t=p.onTabChange)||t.call(p,e)}},[a.dates,a.datesMap,p]);(0,l.useEffect)(()=>()=>a.reset(),[a]),(0,h.Jzs)(a.isResolved);let M=(0,l.useMemo)(()=>{var t;return a.isRejected?(0,i.jsx)(v.w,{className:(0,r.$)(_().error,_().important),withBackwardControl:!1}):a.isShimmerVisible?(0,i.jsx)(I,{isActive:a.isShimmerActive}):a.isEmpty?(0,i.jsx)("div",{className:_().empty,children:(0,i.jsx)(m.Caption,{variant:"div",size:"m",weight:"normal",children:(0,i.jsx)(n.A,{id:"music-history.empty-title"})})}):null==(t=a.tabs)?void 0:t.map((t,a)=>(0,i.jsx)(u.ln,{onTabShowOrHide:A,"data-intersection-property-id":t.date,tab:t,tabIndex:a,shouldHideInactiveTab:e},a))},[A,a.isEmpty,a.isRejected,a.isShimmerActive,a.isShimmerVisible,a.tabs,e]),C=(0,u.lT)(),H=(0,l.useMemo)(()=>(0,i.jsx)(y.wI,{isShimmerVisible:a.isShimmerVisible,className:_().tabs,...p,onTabChange:j,shimmer:(0,i.jsx)(y.zr,{className:_().tabs,shimmerClassName:(0,r.$)(_().tab,{[_().tab_isLoading]:a.isShimmerVisible}),count:5}),children:a.dates.map((e,t)=>(0,i.jsx)(y.oz,{className:(0,r.$)(_().tab,{[_().tab_selected]:t===p.value}),titleClassName:_().date,"aria-label":C(e,!1),title:C(e,!1),value:t},t))}),[C,j,a.dates,a.isShimmerVisible,p]);return a.isNeededToLoad&&(0,l.use)(a.getMusicHistory()),(0,i.jsx)(h.nVz,{pageId:h._Q$.HISTORY,children:(0,i.jsxs)("div",{className:_().root,...(0,o.Am)(o.Xk.musicHistory.MUSIC_HISTORY_PAGE),children:[(0,i.jsxs)("div",{className:_().headerContainer,children:[(0,i.jsxs)("div",{className:_().header,children:[(0,i.jsx)(y.Lh,{withForwardControl:!1}),(0,i.jsx)(m.Heading,{variant:"h1",weight:"bold",size:"xl",lineClamp:1,children:(0,i.jsx)(n.A,{id:"music-history.title"})})]}),(0,i.jsx)(y.FY,{className:_().carousel,carouselElement:H})]}),(0,i.jsxs)(c.N,{ref:g,className:_().scroll,containerClassName:_().scrollContainer,children:[(0,i.jsx)(x,{children:(0,i.jsx)("div",{className:_().content,children:M})}),(0,i.jsx)(y.A,{children:(0,i.jsx)(y.wi,{className:_().footer})})]})]})})})},74557:(e,t,a)=>{"use strict";a.d(t,{MusicHistoryTab:()=>L});var i=a(33008),r=a(97531),s=a(66268),l=a(61475),n=a(77868),o=a(94767),c=a(54990),d=a(78087),m=a(85896),u=a(96560),v=a(48509),h=a(70879),y=a(53799);let g=e=>{let{entityId:t,from:a}=e;return{contextData:{type:v.K.Various,meta:{id:t},from:a},queueParams:{index:0},loadContextMeta:!0}},x=e=>{let{id:t,tabIndex:a,blockIndex:i,trackIndex:r}=e,{musicHistory:l}=(0,o.Pjs)(),n=(0,s.useId)(),d=(0,s.useRef)(null),{observeElement:m,unobserveElement:u}=(0,s.useContext)(c.MusicHistoryIntersectionObserverContext);return(0,s.useEffect)(()=>{let e=void 0!==r?"".concat(a,"_").concat(i,"_").concat(r,"_").concat(t):"".concat(a,"_").concat(i,"_").concat(t),s=l.indexesMap.get(e);l.isInObservationRange(s)&&m({elementRef:d,elementId:n,index:s,onShow(){l.getItems(this.index),u(n)}})},[i,t,n,l,m,a,r,u]),{intersectionPropertyId:n,ref:d}};var b=a(44078),p=a(87453),_=a.n(p);let k=(0,r.PA)(e=>{let{type:t,track:a,artists:r,tabIndex:s,blockIndex:l,trackIndex:n,playContextParams:c}=e,{ref:d,intersectionPropertyId:m}=x({id:a.id,tabIndex:s,blockIndex:l,trackIndex:n});return a.isShimmerVisible||!a.data?(0,i.jsx)("div",{"data-intersection-property-id":m,ref:d,children:(0,i.jsx)(y.DS,{isActive:a.isShimmerActive,"data-intersection-property-id":m,className:_().trackShimmer,variant:t===v.K.Album?o.Xjt.ALBUM:o.Xjt.PLAYLIST})}):t===v.K.Album?(0,i.jsx)(b.FR,{track:a.data,position:a.data.index,albumArtists:r,playContextParams:c}):(0,i.jsx)(b.Kt,{track:a.data,playContextParams:c})});var S=a(64552),j=a.n(S);let I=(0,r.PA)(e=>{var t,a,r,l,c;let{album:d,tabIndex:b,blockIndex:p}=e,{ref:_,intersectionPropertyId:S}=x({id:d.id,tabIndex:b,blockIndex:p}),{from:I}=(0,o.fyy)({blockId:"album-".concat(d.id)}),A=(0,s.useMemo)(()=>{var e,t;return d.available?(0,i.jsx)(h.iQ,{className:j().artists,linkClassName:j().artistLink,artists:null==(e=d.meta)?void 0:e.artists,lineClamp:1}):null==(t=d.meta)?void 0:t.artistNames},[d.available,null==(t=d.meta)?void 0:t.artistNames,null==(a=d.meta)?void 0:a.artists]),M=(0,s.useMemo)(()=>{var e,t,a;return d.isShimmerVisible?(0,i.jsx)(y.Mo,{isActive:d.isShimmerActive,className:j().header,withDescription:!0}):(0,i.jsx)(y.Tw,{className:j().header,coverUrl:null==(e=d.meta)?void 0:e.coverUri,title:null==(t=d.meta)?void 0:t.title,titleSize:"xs",titleLineClamp:1,description:A,titleClassName:j().headerTitle,viewAllActionLink:null==(a=d.meta)?void 0:a.url,available:d.available,fallbackIconVariant:"album",headingVariant:"h4",withCover:!0,withDescription:!!A})},[d.available,d.isShimmerActive,d.isShimmerVisible,null==(r=d.meta)?void 0:r.coverUri,null==(l=d.meta)?void 0:l.title,null==(c=d.meta)?void 0:c.url,A]),C=(0,s.useMemo)(()=>d.tracks.map((e,t)=>{var a;let r=g({entityId:e.entityId,from:I});return(0,i.jsx)(k,{type:v.K.Album,track:e,playContextParams:r,tabIndex:b,blockIndex:p,trackIndex:t},null==(a=e.data)?void 0:a.getKey(t))}),[d.tracks,I,b,p]);return(0,i.jsxs)("section",{className:j().root,ref:_,"data-intersection-property-id":S,children:[(0,i.jsx)(n.Heading,{className:(0,m.$)(j().header,j().heading),variant:"h3",children:(0,i.jsx)(u.A,{id:"music-history.album"})}),M,(0,i.jsx)("div",{className:j().content,children:C})]})}),A=(0,r.PA)(e=>{var t,a,r;let{artist:l,tabIndex:c,blockIndex:d}=e,{ref:h,intersectionPropertyId:b}=x({id:l.id,tabIndex:c,blockIndex:d}),{from:p}=(0,o.fyy)({blockId:"artist-".concat(l.id)}),_=(0,s.useMemo)(()=>{var e,t,a;return l.isShimmerVisible?(0,i.jsx)(y.Mo,{isActive:l.isShimmerActive,className:j().header,coverRadius:"round"}):(0,i.jsx)(y.Tw,{titleSize:"xs",titleLineClamp:1,className:j().header,coverUrl:null==(e=l.meta)?void 0:e.coverUri,title:null==(t=l.meta)?void 0:t.name,titleClassName:j().headerTitle,viewAllActionLink:null==(a=l.meta)?void 0:a.url,available:l.available,withCover:!0,coverRadius:"round",headingVariant:"h4"})},[l.available,l.isShimmerActive,l.isShimmerVisible,null==(t=l.meta)?void 0:t.coverUri,null==(a=l.meta)?void 0:a.name,null==(r=l.meta)?void 0:r.url]),S=(0,s.useMemo)(()=>l.tracks.map((e,t)=>{var a;let r=g({entityId:e.entityId,from:p});return(0,i.jsx)(k,{type:v.K.Artist,track:e,playContextParams:r,tabIndex:c,blockIndex:d,trackIndex:t},null==(a=e.data)?void 0:a.getKey(t))}),[l.tracks,p,c,d]);return(0,i.jsxs)("section",{className:j().root,ref:h,"data-intersection-property-id":b,children:[(0,i.jsx)(n.Heading,{className:(0,m.$)(j().header,j().heading),variant:"h3",children:(0,i.jsx)(u.A,{id:"music-history.artist"})}),_,(0,i.jsx)("div",{className:j().content,children:S})]})}),M=(0,r.PA)(e=>{let{common:t,tabIndex:a,blockIndex:r}=e,{ref:c,intersectionPropertyId:d}=x({id:t.id,tabIndex:a,blockIndex:r}),{from:h}=(0,o.fyy)(),y=(0,s.useMemo)(()=>t.tracks.map((e,t)=>{var s;let l=g({entityId:e.entityId,from:h});return(0,i.jsx)(k,{playContextParams:l,type:v.K.Various,track:e,tabIndex:a,blockIndex:r,trackIndex:t},null==(s=e.data)?void 0:s.getKey(t))}),[t.tracks,h,a,r]),b=(0,s.useMemo)(()=>{switch(t.type){case l.D.OTHER:return(0,i.jsx)(u.A,{id:"music-history.shuffle"});case l.D.SEARCH:return(0,i.jsx)(u.A,{id:"music-history.search"})}},[t.type]);return(0,i.jsxs)("section",{className:j().root,ref:c,"data-intersection-property-id":d,children:[(0,i.jsx)(n.Heading,{className:(0,m.$)(j().header,j().heading),variant:"h3",children:b}),(0,i.jsx)("div",{className:j().content,children:y})]})});var C=a(73827);let H=(0,r.PA)(e=>{var t,a,r,l,c;let{playlist:d,tabIndex:h,blockIndex:b}=e,{ref:p,intersectionPropertyId:_}=x({id:d.id,tabIndex:h,blockIndex:b}),{from:S}=(0,o.fyy)({blockId:d.isResolved?"playlist-".concat(null==(t=d.meta)?void 0:t.id):""}),{formatMessage:I}=(0,C.A)(),A=(0,s.useMemo)(()=>{var e,t,a,r;return d.isShimmerVisible?(0,i.jsx)(y.Mo,{isActive:d.isShimmerActive,className:j().header,withDescription:!0}):(0,i.jsx)(y.Tw,{className:j().header,titleSize:"xs",titleLineClamp:1,coverUrl:null==(e=d.meta)?void 0:e.coverUri,title:null==(t=d.meta)?void 0:t.title,titleClassName:j().headerTitle,description:I({id:"entity-names.number-of-tracks"},{counter:null==(a=d.meta)?void 0:a.tracksCount}),fallbackIconVariant:"playlist",withCover:!0,viewAllActionLink:null==(r=d.meta)?void 0:r.url,headingVariant:"h4",withDescription:!0})},[I,d.isShimmerActive,d.isShimmerVisible,null==(a=d.meta)?void 0:a.coverUri,null==(r=d.meta)?void 0:r.title,null==(l=d.meta)?void 0:l.tracksCount,null==(c=d.meta)?void 0:c.url]),M=(0,s.useMemo)(()=>d.tracks.map((e,t)=>{var a;let r=g({entityId:e.entityId,from:S});return(0,i.jsx)(k,{playContextParams:r,type:v.K.Playlist,track:e,tabIndex:h,blockIndex:b,trackIndex:t},null==(a=e.data)?void 0:a.getKey(t))}),[d.tracks,S,h,b]);return(0,i.jsxs)("section",{className:j().root,ref:p,"data-intersection-property-id":_,children:[(0,i.jsx)(n.Heading,{className:(0,m.$)(j().header,j().heading),variant:"h3",children:(0,i.jsx)(u.A,{id:"music-history.playlist"})}),A,(0,i.jsx)("div",{className:j().content,children:M})]})});var N=a(42314);let f=(0,r.PA)(e=>{var t,a;let{vibe:r,blockIndex:l,tabIndex:c}=e,{experiments:d}=(0,o.Pjs)(),h=d.checkExperiment(o.zal.WebNextVibeDescription,"on"),{ref:b,intersectionPropertyId:p}=x({id:r.id,blockIndex:l,tabIndex:c}),{from:_}=(0,o.fyy)({blockId:"wave-".concat(r.id)}),S=(0,N.L)(()=>{var e,t,a,i,s,l,n,o;return h?{title:null==(e=r.meta)?void 0:e.title,description:null==(i=r.meta)?void 0:i.getDescription(null!=(o=null==(t=r.meta)?void 0:t.title)?o:null==(a=r.meta)?void 0:a.description)}:{title:null!=(n=null==(s=r.meta)?void 0:s.title)?n:null==(l=r.meta)?void 0:l.description}}),I=(0,s.useMemo)(()=>{var e,t;return r.isShimmerVisible?(0,i.jsx)(y.Mo,{isActive:r.isShimmerActive,className:j().header,coverRadius:"round"}):(0,i.jsx)(y.Tw,{titleSize:"xs",titleLineClamp:1,className:j().header,coverUrl:null==(e=r.meta)?void 0:e.imageUrl,titleClassName:j().headerTitle,coverBackgroundColor:null==(t=r.meta)?void 0:t.backgroundColor,coverRadius:"round",headingVariant:"h4",...S})},[S,r.isShimmerActive,r.isShimmerVisible,null==(t=r.meta)?void 0:t.backgroundColor,null==(a=r.meta)?void 0:a.imageUrl]),A=(0,s.useMemo)(()=>r.tracks.map((e,t)=>{var a;let r=g({entityId:e.entityId,from:_});return(0,i.jsx)(k,{playContextParams:r,type:v.K.Vibe,track:e,blockIndex:l,tabIndex:c,trackIndex:t},null==(a=e.data)?void 0:a.getKey(t))}),[r.tracks,_,c,l]);return(0,i.jsxs)("section",{className:j().root,ref:b,"data-intersection-property-id":p,children:[!h&&(0,i.jsx)(n.Heading,{className:(0,m.$)(j().header,j().heading),variant:"h3",children:(0,i.jsx)(u.A,{id:"music-history.my-vibe"})}),I,(0,i.jsx)("div",{className:j().content,children:A})]})});var w=a(28149),T=a.n(w);let L=(0,r.PA)(e=>{let{tab:t,tabIndex:a,onTabShowOrHide:r,shouldHideInactiveTab:m,...u}=e,{musicHistory:v}=(0,o.Pjs)(),h=(0,s.useMemo)(()=>{var e;return null==(e=t.blocks)?void 0:e.map((e,t)=>{switch(e.type){case l.D.ALBUM:return(0,i.jsx)(I,{album:e,blockIndex:t,tabIndex:a},"".concat(e.key,"_").concat(t));case l.D.PLAYLIST:return(0,i.jsx)(H,{playlist:e,blockIndex:t,tabIndex:a},"".concat(e.key,"_").concat(t));case l.D.WAVE:return(0,i.jsx)(f,{vibe:e,blockIndex:t,tabIndex:a},"".concat(e.key,"_").concat(t));case l.D.ARTIST:return(0,i.jsx)(A,{artist:e,blockIndex:t,tabIndex:a},"".concat(e.key,"_").concat(t));case l.D.SEARCH:case l.D.OTHER:return(0,i.jsx)(M,{common:e,blockIndex:t,tabIndex:a},"".concat(e.key,"_").concat(t));default:return null}}).filter(e=>e)},[t.blocks,a]),y=(0,d.useFormatDate)(),g=(0,s.useRef)(null),{observeElement:x}=(0,s.useContext)(c.MusicHistoryIntersectionObserverContext),b=v.datesMap.get(t.date);return(0,s.useEffect)(()=>{x({elementId:t.date,elementRef:g,index:0,onShow:()=>{v.setDatesMap(t.date,!0),r()},onHide:()=>{v.setDatesMap(t.date,!1),r()}})},[v,v.datesMap,x,r,t.date]),(0,i.jsxs)("div",{"aria-hidden":!b&&m,ref:g,"data-intersection-property-id":t.date,className:T().root,...u,...{inert:!!(!b&&m)},children:[(0,i.jsx)(n.Heading,{"data-date-anchor":t.date,className:T().date,variant:"h2",size:"m",children:y(t.date)}),(0,i.jsx)("div",{className:T().content,children:h})]})})},78087:(e,t,a)=>{"use strict";a.d(t,{useFormatDate:()=>s});var i=a(66268),r=a(73827);let s=()=>{let{formatDate:e,formatRelativeTime:t}=(0,r.A)();return(0,i.useCallback)(function(a){let i=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=new Date(a),s=new Date;r.setHours(0,0,0,0),s.setHours(0,0,0,0);let l=(r.getTime()-s.getTime())/864e5,n=t(l,"day",{numeric:"auto"}),o=e(a,{day:"numeric",month:"long"});switch(l){case 0:case -1:case -2:if(i)return"".concat(n,", ").concat(o);return n;default:return o}},[e,t])}},87453:e=>{e.exports={trackShimmer:"MusicHistoryTrack_trackShimmer__yxcx9"}},91907:e=>{e.exports={root:"MusicHistoryPage_root__FYB2m",scroll:"MusicHistoryPage_scroll__ykpDX",scrollContainer:"MusicHistoryPage_scrollContainer__eemvg",headerContainer:"MusicHistoryPage_headerContainer__QG0L3",header:"MusicHistoryPage_header__dzEvD",content:"MusicHistoryPage_content__j4evw",footer:"MusicHistoryPage_footer__Vu7aC",empty:"MusicHistoryPage_empty__fQRHA",carousel:"MusicHistoryPage_carousel__jcl8l",tabs:"MusicHistoryPage_tabs__v_5Zg",tab:"MusicHistoryPage_tab__WDE1e",tab_isLoading:"MusicHistoryPage_tab_isLoading__nNqd2",tab_selected:"MusicHistoryPage_tab_selected__nmn8P",date:"MusicHistoryPage_date__OV6rR",error:"MusicHistoryPage_error__9f_8i",important:"MusicHistoryPage_important__qNFO8"}}}]);